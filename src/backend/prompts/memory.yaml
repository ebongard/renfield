# Memory Extraction Prompts
# Used by ConversationMemoryService.extract_and_save() to extract
# memorable facts from conversation exchanges.

de:
  extraction_prompt: |
    Analysiere den folgenden Dialog und extrahiere erinnerungswuerdige Fakten ueber den Benutzer.

    EXTRAHIERE:
    - Praeferenzen ("Ich mag Jazz", "Ich trinke keinen Kaffee")
    - Persoenliche Fakten ("Ich heisse Max", "Mein Hund heisst Bello")
    - Stehende Anweisungen ("Sprich mich mit Du an", "Antworte immer auf Englisch")
    - Relevanter Kontext ("Ich plane eine Reise nach Hamburg", "Die Heizung ist kaputt")

    IGNORIERE:
    - Einmalige Befehle ("Schalte das Licht ein", "Wie wird das Wetter?")
    - Smalltalk ohne persoenlichen Inhalt
    - Technische Systemantworten
    - Informationen die der Assistent gegeben hat (nur Fakten VOM Benutzer)

    Dialog:
    User: {user_message}
    Assistent: {assistant_response}

    Antwort als JSON-Array (leeres Array [] wenn nichts erinnerungswuerdig):
    [{{"content": "...", "category": "preference|fact|instruction|context", "importance": 0.1-1.0}}]

  extraction_system: "Du extrahierst Fakten aus Dialogen. Antworte NUR mit einem JSON-Array."

  contradiction_resolution_prompt: |
    Ein neuer Fakt wurde aus einem Gespraech extrahiert. Vergleiche ihn mit bestehenden Erinnerungen und entscheide, was zu tun ist.

    NEUER FAKT:
    "{new_fact}"

    BESTEHENDE ERINNERUNGEN:
    {existing_memories}

    ENTSCHEIDE eine Aktion:
    - ADD: Der Fakt ist wirklich neu und widerspricht keiner Erinnerung.
    - UPDATE: Der Fakt korrigiert oder aktualisiert eine bestehende Erinnerung (z.B. neuer Wohnort, neuer Name). Gib die Ziel-ID und den aktualisierten Inhalt an.
    - DELETE: Der Fakt macht eine bestehende Erinnerung komplett ungueltig. Gib die Ziel-ID an.
    - NOOP: Der Fakt ist bereits bekannt (inhaltlich identisch mit einer Erinnerung).

    Antworte NUR mit einem JSON-Objekt:
    {{"action": "ADD|UPDATE|DELETE|NOOP", "target_memory_id": null, "updated_content": null, "reason": "..."}}

  contradiction_resolution_system: "Du vergleichst Fakten mit bestehenden Erinnerungen. Antworte NUR mit einem JSON-Objekt."

en:
  extraction_prompt: |
    Analyze the following dialog and extract memorable facts about the user.

    EXTRACT:
    - Preferences ("I like jazz", "I don't drink coffee")
    - Personal facts ("My name is Max", "My dog is called Bello")
    - Standing instructions ("Use informal language", "Always reply in German")
    - Relevant context ("I'm planning a trip to Hamburg", "The heater is broken")

    IGNORE:
    - One-time commands ("Turn on the light", "What's the weather?")
    - Smalltalk without personal content
    - Technical system responses
    - Information given BY the assistant (only facts FROM the user)

    Dialog:
    User: {user_message}
    Assistant: {assistant_response}

    Reply as JSON array (empty array [] if nothing memorable):
    [{{"content": "...", "category": "preference|fact|instruction|context", "importance": 0.1-1.0}}]

  extraction_system: "You extract facts from dialogs. Reply ONLY with a JSON array."

  contradiction_resolution_prompt: |
    A new fact was extracted from a conversation. Compare it with existing memories and decide what to do.

    NEW FACT:
    "{new_fact}"

    EXISTING MEMORIES:
    {existing_memories}

    DECIDE one action:
    - ADD: The fact is genuinely new and does not contradict any memory.
    - UPDATE: The fact corrects or updates an existing memory (e.g. new city, new name). Provide the target ID and updated content.
    - DELETE: The fact completely invalidates an existing memory. Provide the target ID.
    - NOOP: The fact is already known (semantically identical to an existing memory).

    Reply ONLY with a JSON object:
    {{"action": "ADD|UPDATE|DELETE|NOOP", "target_memory_id": null, "updated_content": null, "reason": "..."}}

  contradiction_resolution_system: "You compare facts with existing memories. Reply ONLY with a JSON object."

# LLM options for extraction (low temperature for consistency)
llm_options:
  temperature: 0.1
  top_p: 0.2
  num_predict: 500
  num_ctx: 4096

# LLM options for contradiction resolution (deterministic, short output)
contradiction_llm_options:
  temperature: 0.0
  num_predict: 200
  num_ctx: 4096
