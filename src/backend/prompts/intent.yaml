  # Intent Extraction Prompts
# Used by OllamaService.extract_intent()

# Main intent extraction prompt template
# Available variables: {message}, {room_context}, {history_context}, {plugin_context}, {entity_context}
extraction_prompt: |
  Erkenne den Intent für diese Nachricht: "{message}"
  {room_context}
  {history_context}

  INTENT-TYPEN:

  CORE INTENTS:
  - homeassistant.turn_on: Gerät einschalten
  - homeassistant.turn_off: Gerät ausschalten
  - homeassistant.get_state: Status abfragen
  - general.conversation: Normale Konversation (kein Smart Home)

  {plugin_context}

  {entity_context}

  BEISPIELE:
  1. "Schalte Licht ein" → {{"intent":"homeassistant.turn_on","parameters":{{"entity_id":"light.xxx"}}}}
  2. "Ist Fenster offen?" → {{"intent":"homeassistant.get_state","parameters":{{"entity_id":"binary_sensor.xxx"}}}}
  3. "Wie geht es dir?" → {{"intent":"general.conversation","parameters":{{}}}}

  WICHTIG: Verwende NUR Intents aus der Liste oben! Antworte NUR mit JSON, kein Text!

# Room context template
room_context_template: |
  RAUM-KONTEXT: Der Benutzer befindet sich im Raum '{room_name}'.
  Wenn der Benutzer 'das Licht' oder 'die Lampe' sagt ohne Raumnamen, bevorzuge Geräte im Raum '{room_name}'.

# Speaker context template
speaker_context_template: "SPRECHER: {speaker_name}"

# Conversation history template for reference resolution
history_context_template: |
  KONVERSATIONS-HISTORIE (für Referenz-Auflösung):
  {history_lines}

  WICHTIG bei Referenzen:
  - Wenn der Nutzer "dort", "da", "dorthin" sagt, beziehe es auf den letzten genannten ORT in der Historie
  - Wenn der Nutzer "es", "das", "die", "den" sagt, beziehe es auf das letzte OBJEKT/GERÄT
  - Ersetze Referenzen durch die konkreten Werte aus der Historie in den Parametern
  - Beispiel: Wenn vorher "Berlin" erwähnt wurde und der Nutzer "dort" sagt, nutze "Berlin" im Query

# System message for JSON-only responses
json_system_message: "Antworte nur mit JSON."

# LLM options for intent extraction
llm_options:
  temperature: 0.0
  top_p: 0.1
  num_predict: 300
