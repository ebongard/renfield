# Renfield Satellite Configuration
# Copy this file to /opt/renfield-satellite/config/satellite.yaml

# Satellite identification
satellite:
  id: "sat-livingroom"        # Unique ID for this satellite
  room: "Living Room"         # Human-readable room name
  language: "de"              # Language for STT/TTS (e.g., 'de', 'en')

# Renfield server connection
# If url is not specified, auto-discovery will find the server automatically
server:
  # url: "ws://renfield.local:8000/ws/satellite"  # Manual WebSocket URL (optional)
  auto_discover: true         # Use zeroconf to find server automatically
  discovery_timeout: 10       # Seconds to wait for discovery
  reconnect_interval: 5       # Seconds between reconnect attempts
  heartbeat_interval: 30      # Seconds between heartbeats
  # Authentication (only needed if server has WS_AUTH_ENABLED=true)
  auth_enabled: false         # Set to true when server requires authentication
  # auth_token: "..."         # Pre-configured token (optional, will auto-fetch if not set)

# Audio settings
audio:
  sample_rate: 16000          # Hz (must match wake word model)
  chunk_size: 1280            # Samples per chunk (~80ms at 16kHz)
  channels: 2                 # Stereo (required for beamforming)
  device: "capture"           # ALSA capture device (see .asoundrc)
  playback_device: "plughw:0,0"  # ALSA playback device
  beamforming:
    enabled: true             # Delay-and-Sum beamforming for noise rejection
    mic_spacing: 0.058        # ReSpeaker 2-Mics HAT: 58mm microphone spacing
    steering_angle: 0.0       # 0 = front-facing, 90 = right, -90 = left

# Wake word detection
wakeword:
  model: "alexa"              # Wake word model name (alexa, hey_jarvis, etc.)
  threshold: 0.5              # Detection threshold (0.0-1.0)
  models_path: "/opt/renfield-satellite/models"
  refractory_seconds: 2.0     # Cooldown before re-triggering same wake word
  # stop_words:               # Words that cancel ongoing interaction (optional)
  #   - "stop"
  #   - "cancel"
  #   - "nevermind"

# Voice Activity Detection (for end-of-speech)
# Note: On Pi Zero 2 W with 4-mic HAT, use "rms" backend â€” Silero VAD's ONNX
# inference competes with openwakeword for CPU and produces unreliable results.
# RMS is essentially free and directly measures audio volume.
vad:
  backend: "silero"           # "rms" (simple), "webrtc" (fast), or "silero" (ML-based, best)
  silence_threshold: 500      # RMS threshold (for "rms" backend)
  silence_duration_ms: 2000   # How long silence to end recording (ms)
  min_listening_seconds: 5.0  # Grace period before silence detection starts
  max_recording_seconds: 20   # Maximum recording length
  silero_threshold: 0.5       # Silero VAD threshold 0-1 (higher = stricter)
  # webrtc_aggressiveness: 2  # WebRTC aggressiveness 0-3 (for "webrtc" backend only)

# LED settings (ReSpeaker HAT)
led:
  brightness: 20              # 0-31 (hardware limit)
  num_leds: 3                 # Number of APA102 LEDs

# Button settings (ReSpeaker HAT)
button:
  gpio_pin: 17                # BCM GPIO pin number
  debounce_ms: 50             # Debounce time
